<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×¨×©×™××ª ×›×œ ×”××©×ª××©×™×</title>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            padding: 30px; 
            background-color: #f4f6f9; 
            direction: rtl; 
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #007bff;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        h2 {
            color: #28a745;
            border-bottom: 2px solid #28a745;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .user-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: grid;
            grid-template-columns: 2fr 2fr 1fr;
            gap: 20px;
            align-items: center;
        }
        .user-item:last-child {
            border-bottom: none;
        }
        .user-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        .user-password {
            color: #007bff;
            font-size: 1.2em;
            font-weight: bold;
            background-color: #e7f3ff;
            padding: 5px 15px;
            border-radius: 6px;
            display: inline-block;
        }
        .user-role {
            color: #666;
            font-size: 0.9em;
        }
        .superadmin-item {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .class-section {
            margin-bottom: 30px;
            border-left: 4px solid #17a2b8;
            padding-left: 15px;
        }
        .class-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #17a2b8;
            margin-bottom: 10px;
        }
        .copy-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .copy-btn:hover {
            background-color: #218838;
        }
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“‹ ×¨×©×™××ª ×›×œ ×”××©×ª××©×™× ×‘××¢×¨×›×ª</h1>

        <!-- ×× ×”×œ×™-×¢×œ -->
        <div class="section">
            <h2>ğŸ‘‘ ×× ×”×œ×™-×¢×œ</h2>
            <div class="superadmin-item">
                <div class="user-item">
                    <div class="user-name">×™××™×¨ ×¤×¨×™×©</div>
                    <div>
                        <span class="user-role">×¡×™×¡××”:</span>
                        <span class="user-password" id="admin1">prha12345</span>
                    </div>
                    <button class="copy-btn" onclick="copyText('prha12345')">×”×¢×ª×§</button>
                </div>
            </div>
            <div class="superadmin-item">
                <div class="user-item">
                    <div class="user-name">×™××™×¨ ×¤×¨×¥</div>
                    <div>
                        <span class="user-role">×¡×™×¡××”:</span>
                        <span class="user-password" id="admin2">yair2589</span>
                    </div>
                    <button class="copy-btn" onclick="copyText('yair2589')">×”×¢×ª×§</button>
                </div>
            </div>
        </div>

        <!-- ×›×™×ª×•×ª, ××•×¨×™× ×•×ª×œ××™×“×™× -->
        <div class="section">
            <h2>ğŸ« ×›×™×ª×•×ª, ××•×¨×™× ×•×ª×œ××™×“×™×</h2>
            <div id="classesData" class="loading">×˜×•×¢×Ÿ × ×ª×•× ×™×...</div>
        </div>
    </div>

    <script>
        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('×”×¡×™×¡××” ×”×•×¢×ª×§×”: ' + text);
            });
        }

        async function loadAllData() {
            try {
                // ×˜×¢×™× ×ª ×›×™×ª×•×ª
                const classesRes = await fetch('/api/classes');
                const classes = await classesRes.json();

                const container = document.getElementById('classesData');
                
                if (classes.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #999;">××™×Ÿ ×›×™×ª×•×ª ×‘××¢×¨×›×ª</p>';
                    return;
                }

                container.innerHTML = '';

                for (const cls of classes) {
                    // ×™×¦×™×¨×ª div ×œ×›×™×ª×”
                    const classDiv = document.createElement('div');
                    classDiv.className = 'class-section';
                    
                    let html = `
                        <div class="class-name">×›×™×ª×”: ${cls.name || '×œ×œ× ×©×'}</div>
                        
                        <!-- ××•×¨×” -->
                        <div style="background-color: #e7f3ff; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <div class="user-item">
                                <div class="user-name">ğŸ‘¨â€ğŸ« ××•×¨×”: ${cls.teacherName || '×œ× ×”×•×’×“×¨'}</div>
                                <div>
                                    <span class="user-role">×¡×™×¡××”:</span>
                                    <span class="user-password">${cls.teacherPassword || '×œ× ×”×•×’×“×¨×”'}</span>
                                </div>
                                <button class="copy-btn" onclick="copyText('${cls.teacherPassword}')">×”×¢×ª×§</button>
                            </div>
                        </div>
                    `;

                    // ×˜×¢×™× ×ª ×ª×œ××™×“×™× ×©×œ ×”×›×™×ª×”
                    try {
                        const studentsRes = await fetch(`/api/students/${cls._id}`);
                        const students = await studentsRes.json();

                        if (students.length > 0) {
                            html += '<div style="margin-top: 20px;"><strong>ğŸ‘¨â€ğŸ“ ×ª×œ××™×“×™×:</strong></div>';
                            students.forEach(student => {
                                html += `
                                    <div class="user-item" style="background-color: #f8f9fa; margin: 5px 0; padding: 10px; border-radius: 6px;">
                                        <div class="user-name">${student.name}</div>
                                        <div>
                                            <span class="user-role">×¡×™×¡××”:</span>
                                            <span class="user-password">${student.id}</span>
                                        </div>
                                        <button class="copy-btn" onclick="copyText('${student.id}')">×”×¢×ª×§</button>
                                    </div>
                                `;
                            });
                        } else {
                            html += '<p style="color: #999; margin-top: 10px;">××™×Ÿ ×ª×œ××™×“×™× ×‘×›×™×ª×”</p>';
                        }
                    } catch (error) {
                        console.error('×©×’×™××” ×‘×˜×¢×™× ×ª ×ª×œ××™×“×™×:', error);
                        html += '<p style="color: red;">×©×’×™××” ×‘×˜×¢×™× ×ª ×ª×œ××™×“×™×</p>';
                    }

                    classDiv.innerHTML = html;
                    container.appendChild(classDiv);
                }

            } catch (error) {
                console.error('×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™×:', error);
                document.getElementById('classesData').innerHTML = '<p style="color: red; text-align: center;">×©×’×™××” ×‘×˜×¢×™× ×ª ×”× ×ª×•× ×™×</p>';
            }
        }

        // ×˜×¢×™× ×” ××•×˜×•××˜×™×ª
        loadAllData();

        // ×¨×¢× ×•×Ÿ ×›×œ 30 ×©× ×™×•×ª
        setInterval(loadAllData, 30000);
    </script>
</body>
</html>
